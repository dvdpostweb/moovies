<!DOCTYPE html>
<head>
  <%= favicon_link_tag "favicon.ico" %>
  <title>
    <%= h @meta_title.blank? ? t('layouts.application.title') : @meta_title %>
  </title>
  <%= include_gon(namespace: 'Plush') %>
  <%= Gon::Base.render_data %>
  <meta http-equiv="content-type" content="text/html;charset=utf-8" />
  <meta name="description" content="<%= @meta_description.blank? ? '' : @meta_description %>">
  <%= stylesheet_link_tag :login %>
	<link href='https://fonts.googleapis.com/css?family=Open+Sans+Condensed:300,300italic,700' rel='stylesheet' type='text/css' />
  <% if false %><%= javascript_include_tag :defaults %><% end %>
  <%= csrf_meta_tag %>
  <%= render :partial => 'layouts/google_analytics' %>
  <%= render :partial => 'layouts/apple' %>
</head>
<body>
    <div id="header_login"> 
      <ul id="lang">
        <li> <%= link_to t('.home').upcase, root_localize_path %> </li>
        <li><%= switch_locale_link(params) %></li>
      </ul>
    </div>
    <% if flash[:notice] %>
        <%= flash[:notice] %>
    <% end %>

    <% if flash[:error] %>
        <%= flash[:error] %>
    <% end %>

    <%= yield %>  
    
    <script   src="https://code.jquery.com/jquery-1.12.4.min.js"   integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ="   crossorigin="anonymous"></script>
    <script   src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.15.0/jquery.validate.js"></script>

    <script>
      $( document ).ready(function() {

        if ((window.location.pathname == "/fr/mon-compte/password/nouveau") || (window.location.pathname == "/nl/mijn-account/password/nieuw") || (window.location.pathname == "/en/my-account/password/new")) {

          $("#new_customer").validate({
            rules: {
              'customer[email]': {
                required: true,
                email: true,
                remote: "/api/v1/check_presence_of_customer_email"
              }
            },
            messages: {
              'customer[email]': {
                required: required_message(),
                email: email_message(),
                remote: remote_message()
              }
            }
          });

        } else if ((window.location.pathname == "/fr/mon-compte/connectez-vous") || (window.location.pathname == "/nl/mijn-account/log-in") || (window.location.pathname == "/en/my-account/log-in")) {

          $("#new_customer").validate({
            rules: {
              'customer[email]': {
                required: true,
                email: true,
                remote: "/api/v1/check_presence_of_customer_email"
              },
              'customer[password]': {
                required: true
              }
            },
            messages: {
              'customer[email]': {
                required: required_message(),
                email: email_message(),
                remote: remote_message()
              },
              'customer[password]': {
                required: login_password()
              }
            }
          });

        }

      });

      function required_message() {
        if (gon.locale == "fr") {
          return "Adresse e-mail est nécessaire."
        } else if (gon.locale == "nl") {
          return "E-mailadres is verplicht."
        } else if (gon.locale == "en") {
          return "Email address is required."
        }
      }

      function email_message() {
        if (gon.locale == "fr") {
          return "Format votre adresse email doit être correcte."
        } else if (gon.locale == "nl") {
          return "Formatteren uw e-mail adres moet correct zijn."
        } else if (gon.locale == "en") {
          return "Format your email address must be correct."
        }
      }

      function remote_message() {
        if (gon.locale == "fr") {
          return "Adresse e-mail ne se trouve pas dans le système."
        } else if (gon.locale == "nl") {
          return "E-mail adres is niet gevonden in het systeem."
        } else if (gon.locale == "en") {
          return "Email address is not found in the system."
        }
      }

      function login_password() {
        if (gon.locale == "fr") {
          return "Champ Mot de passe est nécessaire."
        } else if (gon.locale == "nl") {
          return "Password veld is verplicht."
        } else if (gon.locale == "en") {
          return "Password field is required."
        }
      }

    </script>
</body>
</html>
